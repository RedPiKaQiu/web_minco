# AIèŠå¤©åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## ğŸ“– åŠŸèƒ½æ¦‚è¿°

AIèŠå¤©åŠŸèƒ½é›†æˆäº†é˜¿é‡Œäº‘åƒé—®å¤§è¯­è¨€æ¨¡å‹ï¼Œä¸ºç”¨æˆ·æä¾›æ™ºèƒ½çš„ä»»åŠ¡ç®¡ç†åŠ©æ‰‹å¯¹è¯æœåŠ¡ã€‚æ”¯æŒä¸Šä¸‹æ–‡å¯¹è¯ã€æ„å›¾è¯†åˆ«å’Œæ“ä½œå»ºè®®ã€‚

## ğŸ”§ ç¯å¢ƒé…ç½®

### 1. å®‰è£…ä¾èµ–

```bash
pip install openai==1.40.0
```

### 2. é…ç½®åƒé—®APIå¯†é’¥

åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®åƒé—®APIå¯†é’¥ï¼š

```bash
# Linux/Mac
export QWEN_API_KEY="your_qwen_api_key_here"

# Windows
set QWEN_API_KEY=your_qwen_api_key_here
```

### 3. è·å–åƒé—®APIå¯†é’¥

1. è®¿é—® [é˜¿é‡Œäº‘ç™¾ç‚¼å¹³å°](https://bailian.console.aliyun.com/)
2. åˆ›å»ºåº”ç”¨å¹¶è·å–API-KEY
3. å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š[é€šä¹‰åƒé—®APIè°ƒç”¨æŒ‡å—](https://help.aliyun.com/document_detail/2840915.html)

## ğŸš€ æ¥å£ä½¿ç”¨

### æ¥å£åœ°å€
```
POST /api/v1/ai/chat
```

### è¯·æ±‚æ ¼å¼

```json
{
  "message": "æˆ‘æ„Ÿè§‰æœ‰ç‚¹å¡ä½äº†",
  "context": {
    "recent_tasks": ["task_id1", "task_id2"],
    "current_projects": ["project_id1"],
    "user_mood": "focused",
    "available_time": 30
  },
  "session_id": "å¯é€‰çš„ä¼šè¯IDï¼Œç”¨äºç»´æŠ¤ä¸Šä¸‹æ–‡"
}
```

### å“åº”æ ¼å¼

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "reply": "æˆ‘ç†è§£ä½ çš„æ„Ÿå—ã€‚è¦ä¸è¦è¯•è¯•æŠŠå¤§ä»»åŠ¡æ‹†è§£æˆå°æ­¥éª¤ï¼Ÿ",
    "suggested_actions": [
      {
        "type": "task_breakdown",
        "task_id": "task_id1",
        "label": "æ‹†è§£è¿™ä¸ªä»»åŠ¡",
        "payload": {"action": "break_down_current_task"}
      }
    ],
    "quick_replies": [
      "çœ‹çœ‹è¿™å‘¨æœ‰ä»€ä¹ˆäº‹é¡¹",
      "éœ€è¦ä¸€ç‚¹åŠ¨åŠ›"
    ],
    "session_id": "uuid-session-id",
    "context_updated": true
  }
}
```

## ğŸ’¬ å¯¹è¯åŠŸèƒ½ç‰¹æ€§

### 1. ä¸Šä¸‹æ–‡ç†è§£
- ç»´æŠ¤å¤šè½®å¯¹è¯å†å²
- ç†è§£ç”¨æˆ·å½“å‰ä»»åŠ¡çŠ¶æ€
- æ ¹æ®å¿ƒæƒ…å’Œå¯ç”¨æ—¶é—´æä¾›å»ºè®®

### 2. æ„å›¾è¯†åˆ«
- **å›°éš¾æ±‚åŠ©**: è¯†åˆ«"å¡ä½"ã€"å›°éš¾"ç­‰è¯æ±‡ï¼Œæä¾›ä»»åŠ¡æ‹†è§£å»ºè®®
- **ä»»åŠ¡ç®¡ç†**: è¯†åˆ«ä»»åŠ¡ç›¸å…³éœ€æ±‚ï¼Œæä¾›åˆ›å»ºã€æŸ¥çœ‹æ“ä½œ
- **ä¸“æ³¨å·¥ä½œ**: è¯†åˆ«ä¸“æ³¨éœ€æ±‚ï¼Œå»ºè®®å¼€å§‹ä¸“æ³¨æ¨¡å¼
- **æƒ…ç»ªæ”¯æŒ**: è¯†åˆ«ç„¦è™‘ã€ç–²æƒ«ç­‰æƒ…ç»ªï¼Œæä¾›æ­£é¢æ”¯æŒ

### 3. æ™ºèƒ½å»ºè®®

#### å»ºè®®æ“ä½œç±»å‹
- `task_breakdown`: ä»»åŠ¡æ‹†è§£
- `create_task`: åˆ›å»ºæ–°ä»»åŠ¡
- `view_tasks`: æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨
- `start_focus`: å¼€å§‹ä¸“æ³¨æ¨¡å¼

#### å¿«é€Ÿå›å¤
æ ¹æ®å¯¹è¯å†…å®¹åŠ¨æ€ç”Ÿæˆç›¸å…³çš„å¿«é€Ÿå›å¤é€‰é¡¹ã€‚

## ğŸ§ª æµ‹è¯•ä½¿ç”¨

### 1. å¯åŠ¨æœåŠ¡
```bash
uvicorn app.main:app --reload
```

### 2. è¿è¡Œæµ‹è¯•è„šæœ¬
```bash
# è®¾ç½®APIå¯†é’¥
export QWEN_API_KEY="your_api_key"

# è¿è¡Œæµ‹è¯•
python test_ai_chat.py
```

### 3. æ‰‹åŠ¨æµ‹è¯•ç¤ºä¾‹

```bash
# åŸºç¡€å¯¹è¯æµ‹è¯•
curl -X POST "http://localhost:8000/api/v1/ai/chat" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ä½ å¥½ï¼Œæˆ‘æ˜¯æ–°ç”¨æˆ·",
    "context": {
      "user_mood": "curious"
    }
  }'
```

## ğŸ“Š ä½¿ç”¨åœºæ™¯

### 1. æ–°ç”¨æˆ·å¼•å¯¼
```json
{
  "message": "ä½ å¥½ï¼Œæˆ‘æ˜¯æ–°ç”¨æˆ·ï¼Œä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹",
  "context": {"user_mood": "curious"}
}
```

### 2. ä»»åŠ¡ç®¡ç†å›°éš¾
```json
{
  "message": "æˆ‘æœ‰å¾ˆå¤šäº‹æƒ…è¦åšï¼Œæ„Ÿè§‰å¾ˆæ··ä¹±",
  "context": {
    "recent_tasks": ["task1", "task2", "task3"],
    "user_mood": "overwhelmed"
  }
}
```

### 3. å¯»æ±‚ä¸“æ³¨å»ºè®®
```json
{
  "message": "æˆ‘æƒ³å¼€å§‹å·¥ä½œï¼Œä½†ä¸çŸ¥é“å…ˆåšä»€ä¹ˆ",
  "context": {
    "available_time": 60,
    "user_mood": "focused"
  }
}
```

### 4. æƒ…ç»ªæ”¯æŒ
```json
{
  "message": "ä»Šå¤©å·¥ä½œå‹åŠ›å¾ˆå¤§ï¼Œæ„Ÿè§‰æœ‰ç‚¹ç„¦è™‘",
  "context": {"user_mood": "anxious"}
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. APIå¯†é’¥å®‰å…¨
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç APIå¯†é’¥
- ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡
- å®šæœŸè½®æ¢APIå¯†é’¥

### 2. è´¹ç”¨æ§åˆ¶
- åƒé—®APIæŒ‰tokensè®¡è´¹
- è®¾ç½®åˆé€‚çš„`max_tokens`é™åˆ¶
- ç›‘æ§APIä½¿ç”¨é‡

### 3. é”™è¯¯å¤„ç†
- æ¥å£åŒ…å«å®Œå–„çš„é™çº§æœºåˆ¶
- APIå¤±è´¥æ—¶æä¾›å¤‡ç”¨å›å¤
- è®°å½•è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

### 4. ä¼šè¯ç®¡ç†
- å½“å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ä¼šè¯
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Redis
- ä¼šè¯å†å²é™åˆ¶ä¸º10æ¡æ¶ˆæ¯

## ğŸ”§ ç”Ÿäº§ç¯å¢ƒé…ç½®

### 1. ç¯å¢ƒå˜é‡é…ç½®
```bash
# .env æ–‡ä»¶
QWEN_API_KEY=your_production_api_key
QWEN_API_BASE=https://dashscope.aliyuncs.com/compatible-mode/v1
QWEN_MODEL=qwen-turbo
```

### 2. Redisç¼“å­˜é…ç½®ï¼ˆæ¨èï¼‰
```python
# åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ›¿æ¢å†…å­˜å­˜å‚¨
import redis
redis_client = redis.Redis(host='localhost', port=6379, db=0)
```

### 3. æ—¥å¿—ç›‘æ§
- ç›‘æ§APIè°ƒç”¨æˆåŠŸç‡
- è·Ÿè¸ªå“åº”æ—¶é—´
- è®°å½•ç”¨æˆ·æ»¡æ„åº¦åé¦ˆ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. [é˜¿é‡Œäº‘ç™¾ç‚¼å¹³å°æ–‡æ¡£](https://help.aliyun.com/document_detail/2840915.html)
2. [OpenAI Python SDKæ–‡æ¡£](https://github.com/openai/openai-python)
3. é¡¹ç›®æ—¥å¿—æ–‡ä»¶ï¼š`minco-be.log`

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-12-19)
- âœ… é›†æˆåƒé—®LLM
- âœ… æ”¯æŒä¸Šä¸‹æ–‡å¯¹è¯
- âœ… å®ç°æ„å›¾è¯†åˆ«
- âœ… æ·»åŠ æ™ºèƒ½å»ºè®®æ“ä½œ
- âœ… å®ŒæˆåŸºç¡€æµ‹è¯• 

## ğŸ”„ åç»­å»ºè®®
ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ï¼š
    ä½¿ç”¨Redisæ›¿ä»£å†…å­˜å­˜å‚¨ä¼šè¯
    æ·»åŠ APIè°ƒç”¨ç›‘æ§å’Œé™æµ
    ä¼˜åŒ–æç¤ºè¯å’Œå›å¤è´¨é‡
åŠŸèƒ½æ‰©å±•ï¼š
    é›†æˆæ›´å¤šAIèƒ½åŠ›ï¼ˆä»»åŠ¡åˆ†æã€æ™ºèƒ½è§„åˆ’ç­‰ï¼‰
    æ”¯æŒå¤šç§èŠå¤©æ¨¡å¼
    æ·»åŠ ç”¨æˆ·åå¥½å­¦ä¹ 